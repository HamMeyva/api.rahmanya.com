# Ã‡oklu kullanÄ±cÄ± canlÄ± yayÄ±n sistemi iÃ§in GraphQL ÅŸemasÄ±

# --- ğŸ“Œ Start::Response Models ---
type InviteUserToStreamResponse {
    success: Boolean!
    message: String
    invite_id: ID
}

type AcceptStreamInviteResponse {
    success: Boolean!
    message: String
    token: String
    channel_name: String
    broadcaster_id: ID
}

type RejectStreamInviteResponse {
    success: Boolean!
    message: String
}

type StreamInvite {
    id: ID!
    stream_id: ID!
    inviter_id: ID!
    invitee_id: ID!
    status: String!
    inviter: User @field(resolver: "App\\GraphQL\\Resolvers\\UserResolver@user")
    invitee: User @field(resolver: "App\\GraphQL\\Resolvers\\UserResolver@user")
    created_at: DateTime!
    updated_at: DateTime!
}
# --- ğŸ“Œ End::Response Models ---

# --- ğŸ“Œ Start::Mutations ---
extend type Mutation {
    # KullanÄ±cÄ±yÄ± canlÄ± yayÄ±na davet et
    inviteUserToStream(
        channelName: String!,
        userId: ID!
    ): InviteUserToStreamResponse!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@inviteUserToStream"
        )

    # CanlÄ± yayÄ±n davetini kabul et
    acceptStreamInvite(
        channelName: String!,
        inviterId: ID!
    ): AcceptStreamInviteResponse!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@acceptStreamInvite"
        )

    # CanlÄ± yayÄ±n davetini reddet
    rejectStreamInvite(
        channelName: String!,
        inviterId: ID!
    ): RejectStreamInviteResponse!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@rejectStreamInvite"
        )
        
    # KullanÄ±cÄ±yÄ± canlÄ± yayÄ±ndan Ã§Ä±kar (yayÄ±ncÄ± veya moderatÃ¶r tarafÄ±ndan)
    removeUserFromStream(
        channelName: String!,
        userId: ID!
    ): Boolean!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@removeUserFromStream"
        )
}
# --- ğŸ“Œ End::Mutations ---

# --- ğŸ“Œ Start::Query --- 
extend type Query {
    # KullanÄ±cÄ±nÄ±n bekleyen davetlerini getir
    pendingStreamInvites: [StreamInvite!]!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@pendingStreamInvites"
        )
        
    # YayÄ±ndaki aktif katÄ±lÄ±mcÄ±larÄ± getir
    streamParticipants(channelName: String!): [LiveStreamViewer!]!
        @guard(with: ["sanctum"])
        @field(
            resolver: "App\\GraphQL\\Resolvers\\Agora\\AgoraMultiUserResolver@streamParticipants"
        )
}
# --- ğŸ“Œ End::Query ---
